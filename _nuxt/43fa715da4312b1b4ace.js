(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{182:function(e,t,o){var content=o(186);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(31).default)("ba3edda2",content,!0,{sourceMap:!1})},185:function(e,t,o){"use strict";var n=o(182);o.n(n).a},186:function(e,t,o){(e.exports=o(30)(!1)).push([e.i,".camera_title{width:100%;height:50px;background-color:#20b2aa;opacity:.5}.camera_back{position:absolute;left:0;top:0;font-weight:700;font-size:30px;color:#fff}.video{border:2px solid #20b2aa}.set-camera{position:absolute;top:5px;left:160px;font-size:20px;width:130px;height:40px;background-color:#20b2aa;font-weight:700}",""])},195:function(e,t,o){"use strict";o.r(t);o(21);var n=o(3),r={data:function(){return{video:null,ctracker:null,leftTop:0,leftBottom:0,leftOpen:0,rightTop:0,rightBottom:0,rightOpen:0,openEyeLabel:"閉",eyeBlinkCount:0,currentRate:14,isMajor:!1,isDetencting:!1,isCamera:!1,cameraErr:"",mouseTop:0,mouseBottom:0,mouseOpen:0,openMouseLabel:"ん",mouseCount:0,currentMouseRate:14,isMajor2:!1,isSurvey:!1,mouseOpenCount:0,mouseCountInterval:null}},watch:{mouseOpenCount:function(e){e>=3&&this.a()}},mounted:function(){var e=this;console.log("test",this.$cookies.get("message1"));var t=navigator.mediaDevices.getSupportedConstraints();console.log(t),this.video=document.getElementById("v"),navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){console.log("cam"),e.isCamera=!0,e.video.srcObject=t,e.video.play(),e.ctracker=new clm.tracker,e.ctracker.init(),e.ctracker.start(e.video),e.loop()})).catch((function(t){console.log(t),e.isCamera=!1}))},destroyed:function(){clearInterval(this.mouseCountInterval)},methods:{loop:function(){var e=this;requestAnimationFrame(this.loop);var t=this.ctracker.getCurrentPosition();!1!==t&&(this.leftTop=Math.floor(t[24][1]),this.leftBottom=Math.floor(t[26][1]),this.leftOpen=this.leftBottom-this.leftTop,this.rightTop=Math.floor(t[29][1]),this.rightBottom=Math.floor(t[31][1]),this.rightOpen=this.rightBottom-this.rightTop,!0===this.isOpen(this.leftTop,this.leftBottom)?("閉"==this.openEyeLabel&&0==this.isDetencting&&this.isMajor&&(this.eyeBlinkCount=this.eyeBlinkCount+1,this.isDetencting=!0,setTimeout((function(){e.isDetencting=!1}),500)),this.openEyeLabel="開"):this.openEyeLabel="閉",this.mouseTop=Math.floor(t[60][1]),this.mouseBottom=Math.floor(t[57][1]),this.mouseOpen=this.mouseBottom-this.mouseTop,1==this.isOpen2(this.mouseTop,this.mouseBottom)?("ん"==this.openMouseLabel&&0==this.isSurvey&&(this.mouseCount=this.mouseCount+1,this.isMajor||(this.mouseOpenCount=this.mouseOpenCount+1),this.isSurvey=!0,setTimeout((function(){e.isSurvey=!1}),500),null!==this.mouseCountInterval||this.isMajor||(console.log("startInterval"),this.mouseCountInterval=setInterval((function(){console.log("interval"),e.mouseOpenCount=0,clearInterval(e.mouseCountInterval),e.mouseCountInterval=null}),5e3))),this.openMouseLabel="あ"):this.openMouseLabel="ん")},isOpen:function(e,t){return!(t-e>.845*this.currentRate)},isOpen2:function(e,t){return!(t-e<2*this.currentMouseRate)},a:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";console.log("=== 計測スタート ==="),"button"===t&&alert("撮影を開始します。画面に向かって瞬きをしてください。"),this.eyeBlinkCount=0,this.mouseCount=0,this.isMajor=!0,this.isMajor2=!0,this.currentRate=this.leftOpen,this.currentMouseRate=this.mouseOpen,clearInterval(this.mouseCountInterval),this.mouseCountInterval=null,setTimeout((function(){clearInterval(e.mouseCountInterval),e.mouseOpenCount=0}),200),setTimeout(Object(n.a)(regeneratorRuntime.mark((function o(){var n,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return"button"==t&&alert("測定終了"+e.eyeBlinkCount+"回瞬きを検知しました。"),e.isMajor=!1,e.currentMouseRate=14,n="...",e.eyeBlinkCount>7?("message"+e.eyeBlinkCount,"button"==t&&alert("計測できませんでした"),n="計測できませんでした"):(r="message"+e.eyeBlinkCount,"button"==t&&alert(e.$cookies.get(r)),n=e.$cookies.get(r)),1==e.eyeBlinkCount&&("button"==t&&alert(e.$cookies.get("message1")),n=e.$cookies.get("message1")),2==e.eyeBlinkCount&&("button"==t&&alert(e.$cookies.get("message2")),n=e.$cookies.get("message2")),3==e.eyeBlinkCount&&("button"==t&&alert(e.$cookies.get("message3")),n=e.$cookies.get("message3")),4==e.eyeBlinkCount&&("button"==t&&alert(e.$cookies.get("message4")),n=e.$cookies.get("message4")),5==e.eyeBlinkCount&&("button"==t&&alert(e.$cookies.get("message5")),n=e.$cookies.get("message5")),6==e.eyeBlinkCount&&("button"==t&&alert(e.$cookies.get("message6")),n=e.$cookies.get("message6")),7==e.eyeBlinkCount&&("button"==t&&alert(e.$cookies.get("message7")),n=e.$cookies.get("message7")),o.next=14,e.$axios.post("https://gentle-dawn-83651.herokuapp.com/post",{blinkCount:e.eyeBlinkCount,message:n});case 14:o.sent;case 15:case"end":return o.stop()}}),o)}))),1e4)}}},l=(o(185),o(22)),component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[!1===e.isCamera?o("div",{staticStyle:{background:"#ff5555"}},[o("div",[e._v("カメラが起動していません")]),e._v(" "),e.cameraErr?o("p",[e._v(e._s(e.cameraErr))]):e._e()]):e._e(),e._v(" "),o("div",{staticClass:"camera_title"}),e._v(" "),o("div",{staticClass:"buttons"},[o("button",{staticClass:"button set-camera",on:{click:function(t){return e.a("button")}}},[e._v("撮影")])]),e._v(" "),o("nuxt-link",{staticClass:"camera_back",attrs:{to:{path:"./"}}},[e._v("◀︎back")]),e._v(" "),e.isMajor?o("div",{staticStyle:{background:"#ff0000","text-align":"center",color:"#fff"}},[e._v("\n        計測中\n    ")]):e._e(),e._v(" "),e.mouseCountInterval?o("div",{staticStyle:{background:"#ff8888","text-align":"center",color:"#fff"}},[e._v("\n        起動準備中 "+e._s(e.mouseOpenCount)+"/3\n    ")]):e._e(),e._v(" "),o("div",[o("div",[e._v("現在の値: "+e._s(e.currentRate))]),e._v(" "),o("div",[o("span",{style:{color:"開"==e.openEyeLabel?"#f00":"#000"}},[e._v(e._s(e.openEyeLabel))]),e._v(": "+e._s(e.eyeBlinkCount)+"回")]),e._v(" "),o("div",[e._v("mouse_top: "+e._s(e.mouseTop))]),e._v(" "),o("div",[e._v("mouse_bottom: "+e._s(e.mouseBottom))]),e._v(" "),o("div",[e._v("mouse_open: "+e._s(e.mouseOpen))]),e._v(" "),o("div",[e._v("現在の値: "+e._s(e.currentMouseRate)+" "+e._s(e.mouseCountInterval))]),e._v(" "),o("div",[e._v("口を開けた回数: "+e._s(e.mouseOpenCount))]),e._v(" "),o("div",[o("span",{style:{color:"あ"==e.openMouseLabel?"#f00":"#000"}},[e._v(e._s(e.openMouseLabel))]),e._v(": "+e._s(e.mouseCount)+"回")])]),e._v(" "),o("video",{staticClass:"video",attrs:{id:"v",width:"640",height:"480",autoplay:"",playsinline:""}}),e._v(" "),o("canvas",{attrs:{id:"c",width:"640",height:"480"}})],1)}),[],!1,null,null,null);t.default=component.exports}}]);